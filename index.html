<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <title>Lista FODMAPS PT</title>
    </head>
    <body>
        <main>
            <h1 class="title">FODMAPS e SII</h1>  
            <div class="teor">
                <h2>Baixo</h2>
                <h2>Moderado</h2>
                <h2>Alto</h2>
            </div>
            <div class="teor-descricao">
                <h3>Comer à vontade</h3>
                <h3>Limitado</h3>
                <h3>Evitar ao máximo</h3>
            </div>
           
            <div id="grid">
                <header id=frutas class="categoria-alimentar">
                    <h2>Frutas</h2>
                </header>
                <section class="sub-categoria low">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Mirtilos (até 40g)</li>
                        <li class="item" draggable="true">Morangos</li>
                        <li class="item" draggable="true">Framboesas (até 30g)</li>
                        <li class="item" draggable="true">Laranja</li>
                        <li class="item" draggable="true">Tangerina</li>
                        <li class="item" draggable="true">Kiwi</li>
                        <li class="item" draggable="true">Uvas</li>
                        <li class="item" draggable="true">Abacaxi (em porções pequenas)</li>
                        <li class="item" draggable="true">Melão-cantalupo (em porções pequenas)</li>
                        <li class="item" draggable="true">Papaia</li>
                    </ul>
                </section>
                <section class="sub-categoria mid">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Abacate (até 1/8 da unidade)</li>
                        <li class="item" draggable="true">Romã (até 45g)</li>
                        
                    </ul>
                </section>
                <section class="sub-categoria high">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Maçã</li>
                        <li class="item" draggable="true">Pêra</li>
                        <li class="item" draggable="true">Manga</li>
                        <li class="item" draggable="true">Melancia</li>
                        <li class="item" draggable="true">Pêssego</li>
                        <li class="item" draggable="true">Nectarina</li>
                        <li class="item" draggable="true">Ameixa</li>
                        <li class="item" draggable="true">Caqui</li>
                        <li class="item" draggable="true">Cereja</li>
                        <li class="item" draggable="true">Damasco</li>
                        <li class="item" draggable="true">Figo</li>
                        <li class="item" draggable="true">Frutas secas (tâmaras,passas,alperces secos)</li>
                    </ul>
                </section>
            </div>

            <div id="grid">
                <header id="vegetais" class="categoria-alimentar">
                    <h2>Vegetais</h2>
                </header>
                <section class="sub-categoria low">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Cenoura</li>
                        <li class="item" draggable="true">Espinafre</li>
                        <li class="item" draggable="true">Alface</li>
                        <li class="item" draggable="true">Tomate</li>
                        <li class="item" draggable="true">Pepino</li>
                        <li class="item" draggable="true">Pimento</li>
                        <li class="item" draggable="true">Beringela</li>
                        <li class="item" draggable="true">Courgette (até 65g)</li>
                        <li class="item" draggable="true">Abóbora</li>
                        <li class="item" draggable="true">Nabo</li>
                        <li class="item" draggable="true">Batata</li>
                        <li class="item" draggable="true">Feijão-Verde (até 15 vagens)</li>
                    </ul>
                </section>
                <section class="sub-categoria mid">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Bróculos (até 75g)</li>
                        <li class="item" draggable="true">Couve-roxa (até 40g)</li>
                        <li class="item" draggable="true">Beterraba Cozida (até 20g)</li>
                        <li class="item" draggable="true">Batata Doce (até 75g) </li>
                        <li class="item" draggable="true">Ervilhas</li>
                    </ul>
                </section>
                <section class="sub-categoria high">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Cebola</li>
                        <li class="item" draggable="true">Alho</li>
                        <li class="item" draggable="true">Espargos</li>
                        <li class="item" draggable="true">Couve-Flor</li>
                        <li class="item" draggable="true">Couve de Bruxelas</li>
                        <li class="item" draggable="true">Cogumelos</li>
                        <li class="item" draggable="true">Alcachofra</li>
                    </ul>
                </section>
            </div>

            
            <div id="grid">
                <header id="proteinas" class="categoria-alimentar">
                    <h2>Proteínas</h2>
                </header>
                <section class="sub-categoria low">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Carne (frango,perú,porco) - sem molhos</li>
                        <li class="item" draggable="true">Peixe e marisco</li>
                        <li class="item" draggable="true">Ovos</li>
                        <li class="item" draggable="true">Tofu firme</li>
                    </ul>
                </section>
                <section class="sub-categoria mid">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Carne de Vaca</li>
                    </ul>
                </section>
                <section class="sub-categoria high">                 
                </section>
            </div>
            
             <div id="grid">
                <header id="laticinios" class="categoria-alimentar">
                    <h2>Laticínios</h2>
                </header>
                <section class="sub-categoria low">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Queijos curados (cheddar,parmesão,brie,camembert)</li>
                        <li class="item" draggable="true">Manteiga</li>
                        <li class="item" draggable="true">Bebida Vegetal de Côco</li>
                        <li class="item" draggable="true">Laticínios sem lactose</li>
                    </ul>
                </section>
                <section class="sub-categoria mid">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Bebida Vegetal de Amêndoa</li>
                        <li class="item" draggable="true">Bebida Vegetal de Arroz</li>
                    </ul>
                </section>
                <section class="sub-categoria high">
                    <ul class="sortableLists">
                        <li class="item" draggable="true">Bebida Vegetal de Soja</li>  
                    </ul>
                </section>
            </div>



            <div id="grid">
                <header id="cereais-etc" class="categoria-alimentar">
                    <h2>Cereais, Farináceos, Leguminosas, Frutos Secos e Sementes</h2>
                </header>
                <section class="sub-categoria low">
                    <ul>
                        <li class="item" draggable="true">Arroz</li>
                        <li class="item" draggable="true">Massa</li>
                        <li class="item" draggable="true">Aveia (até 50g)</li>
                        <li class="item" draggable="true">Milho</li>
                        <li class="item" draggable="true">Quinoa</li>
                        <li class="item" draggable="true">Farinha de Arroz</li>
                        <li class="item" draggable="true">Farinha de milho</li>
                        <li class="item" draggable="true">Pão</li>
                        <li class="item" draggable="true">Nozes Pecan</li>
                        <li class="item" draggable="true">Nozes</li>
                        <li class="item" draggable="true">Sementes de Linhaça</li>
                        <li class="item" draggable="true">Sementes de abóbora</li>
                    </ul>
                </section>
                <section class="sub-categoria mid">
                    <ul class="sub-categoria low">
                       <li>Sementes de Chia</li>
                    </ul>
                </section>
                <section class="sub-categoria high">
                    <ul class="sub-categoria low"> 
                        <li class="item" draggable="true">Caju (muito limitado, geralmente evitar)</li>
                        <li class="item" draggable="true">Pistácio (muito limitado)</li>
                        <li class="item" draggable="true">Avelãs</li>
                        <li class="item" draggable="true">Amêndoas</li>
                        <li class="item" draggable="true">Feijão preto, encarnado,branco</li>
                        <li class="item" draggable="true">Lentilhas</li>
                        <li class="item" draggable="true">Grão</li>
                    </ul>
                </section>
            </div>

             <div id="grid">
                <header id="bebidas" class="categoria-alimentar">
                    <h2>Bebidas</h2>
                </header>
                <section class="sub-categoria low">
                    
                </section>
                <section class="sub-categoria mid" >
                    <ul class="sub-categoria low">
                        <li>Água de côco</li>
                    </ul>
                </section>
                <section class="sub-categoria high">
                    <ul class="sub-categoria low"> 
                        <li class="item" draggable="true">Café (é baixo teor, mas para o sii é mau)</li>
                        <li class="item" draggable="true">Chá verde, chá preto (é baixo teor, mas para o sii é mau)</li>
                    </ul>
                </section>
            </div>

            <div id="grid">
                <header id="doces" class="categoria-alimentar">
                    <h2>Adoçantes e outros ingredientes</h2>
                </header>
                <section class="sub-categoria low">
                    
                </section>
                <section class="sub-categoria mid">
                    <ul class="sub-categoria low">
                        
                    </ul>
                </section>
                <section class="sub-categoria high">
                    <ul class="sub-categoria low"> 
                        <li class="item" draggable="true">Mel</li>
                        <li class="item" draggable="true">Frutose</li>
                        <li class="item" draggable="true">Xarope de milho rico em Frutose</li>
                        <li class="item" draggable="true">Polióis: sorbitol, manitol, xilitol, maltitol (presentes em diversos alimentos de compra tipo bolachas, bolos etc)</li>
                    </ul>
                </section>
            </div>



        </main>   

        <script>

            document.addEventListener("DOMContentLoaded", () => {
            const sortableLists = document.querySelectorAll(".sortableLists");

            // Gera um data-index único por item na primeira carga
            sortableLists.forEach((list, listIndex) => {
                list.querySelectorAll(".item").forEach((item, itemIndex) => {
                    if (!item.dataset.index) {
                        item.dataset.index = `${listIndex}-${itemIndex}`;
                    }
                });
            });

            const items = document.querySelectorAll(".item");

            // Salva o local atual de cada item (em que lista ele está e a ordem)
            const saveAllOrders = () => {
                const itemMap = {}; // ex: { "1-0": 0 }

                sortableLists.forEach((list, listIndex) => {
                    list.querySelectorAll(".item").forEach(item => {
                        itemMap[item.dataset.index] = listIndex;
                    });
                });

                const orderMap = {};
                sortableLists.forEach((list, listIndex) => {
                    const order = [...list.querySelectorAll(".item")].map(item => item.dataset.index);
                    orderMap[listIndex] = order;
                });

                localStorage.setItem("itemLocations", JSON.stringify(itemMap));
                localStorage.setItem("itemOrders", JSON.stringify(orderMap));
            };

            // Restaura os itens na lista e ordem corretas
            const restoreAllOrders = () => {
                const itemMap = JSON.parse(localStorage.getItem("itemLocations") || "{}");
                const orderMap = JSON.parse(localStorage.getItem("itemOrders") || "{}");

                // Move os itens para a lista correta
                Object.keys(itemMap).forEach(dataIndex => {
                    const targetListIndex = itemMap[dataIndex];
                    const item = document.querySelector(`.item[data-index="${dataIndex}"]`);
                    const targetList = sortableLists[targetListIndex];
                    if (item && targetList) {
                        targetList.appendChild(item);
                    }
                });

                // Reordena os itens dentro de cada lista
                Object.keys(orderMap).forEach(listIndex => {
                    const list = sortableLists[listIndex];
                    const order = orderMap[listIndex];

                    if (list && order) {
                        order.forEach(dataIndex => {
                            const item = list.querySelector(`.item[data-index="${dataIndex}"]`);
                            if (item) list.appendChild(item);
                        });
                    }
                });
            };

            restoreAllOrders();

            items.forEach(item => {
                item.addEventListener("dragstart", () => {
                    setTimeout(() => item.classList.add("dragging"), 0);
                });
                item.addEventListener("dragend", () => {
                    item.classList.remove("dragging");
                    saveAllOrders(); // Salva em qual lista e posição o item ficou
                });
            });

            const initSortableLists = (e) => {
                e.preventDefault();
                const list = e.currentTarget;
                const draggingItem = document.querySelector(".dragging");

                const siblings = [...list.querySelectorAll(".item:not(.dragging)")];

                let nextSibling = siblings.find(sibling =>
                    e.clientY <= sibling.offsetTop + sibling.offsetHeight / 2
                );

                list.insertBefore(draggingItem, nextSibling);
            };

            sortableLists.forEach(list => {
                list.addEventListener("dragover", initSortableLists);
                list.addEventListener("dragenter", e => e.preventDefault());
            });
        });

            
        </script>

    </body>
</html>